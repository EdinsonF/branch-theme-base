{% assign cart_title = "sections.cart.title" | t %}

{%- liquid
  assign active_reward_one = section.settings.active_reward_one
  assign active_reward_two = section.settings.active_reward_two
  assign amount_reward_one = section.settings.amount_reward_one
  assign amount_reward_two = section.settings.amount_reward_two
  assign amount_free_shipping = section.settings.amount_free_shipping
  assign cart_total = cart.original_total_price
  assign limit_price = amount_free_shipping
-%}
{% if active_reward_one %}
  {% assign limit_price = amount_reward_one %}
{% endif %}
{% if active_reward_two %}
  {% assign limit_price = amount_reward_two %}
{% endif %}


<div class="cart-wrapper">
  {% render 'cart-header'
    title: cart_title,
  %}
  
  {% render 'cart-items' 
    cart: cart
  %}

  {% render 'cart-bar-rewards'
    active_reward_one: active_reward_one, 
    active_reward_two: active_reward_two,
    amount_free_shipping: amount_free_shipping,
    amount_reward_one: amount_reward_one,
    product_reward_one: section.settings.product_reward_one,
    amount_reward_two: amount_reward_two,
    product_reward_two: section.settings.product_reward_two,
    text_free_shipping: section.settings.text_free_shipping,
    text_reward_one: section.settings.text_reward_one,
    text_reward_two: section.settings.text_reward_two,
    limit_price: limit_price,
    cart_total: cart_total
  %}
  
  {% render 'cart-footer'
    cart: cart,
    shipping_info: section.settings.shipping_info,
  %}

  <span class="cart-close">
    {% render 'icon-close' %}
  </span>

</div>

{% schema %}
{
  "name": "Cart",
  "class": "cart",
  "settings": [
    {
      "type": "header",
      "content": "Cart configuration"
    },
    {
      "type": "text",
      "id": "shipping_info",
      "label": "Shipping inf",
      "default": " Le livraison estim√© : J+2/3"
    },
    {
      "type": "header",
      "content": "bar rewards"
    },
    {
      "type": "number",
      "id": "amount_free_shipping",
      "label": "Limit amount free shipping",
      "default": 10
    },
    {
      "type": "text",
      "id": "text_free_shipping",
      "label": "Text free shipping",
      "default": "Livraison offerte !"
    },
    {
      "type": "header",
      "content": "Gift products"
    },
    {
      "type": "number",
      "id": "amount_reward_one",
      "label": "limit amount product one",
      "default": 50
    },
    {
      "type": "text",
      "id": "text_reward_one",
      "label": "Text reward one",
      "default": "Un pilulier offert !"
    },
    {
      "type": "product",
      "id": "product_reward_one",
      "label": "Product one"
    },
    {
      "type": "number",
      "id": "amount_reward_two",
      "label": "limit amount product two",
      "default": 100
    },
    {
      "type": "text",
      "id": "text_reward_two",
      "label": "Text reward two",
      "default": "Un cabas offert!"
    },
    {
      "type": "product",
      "id": "product_reward_two",
      "label": "Product two"
    },
    {
      "type": "header",
      "content": "active rewards"
    },
    {
      "type": "checkbox",
      "id": "active_reward_one",
      "label": "Active reward one",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "active_reward_two",
      "label": "Active reward two",
      "default": true
    }
  ]
}
{% endschema %}