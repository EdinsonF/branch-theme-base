{% assign cart_title = "sections.cart.title" | t %}

{%- liquid
  assign active_reward_two = section.settings.active_reward_two
  assign active_reward_three = section.settings.active_reward_three
  assign amount_reward_one = section.settings.amount_reward_one
  assign amount_reward_two = section.settings.amount_reward_two
  assign amount_reward_three = section.settings.amount_reward_three
  assign cart_total = cart.original_total_price
  assign limit_price = amount_reward_one
-%}
{% if active_reward_two %}
  {% assign limit_price = amount_reward_one %}
{% endif %}
{% if active_reward_three %}
  {% assign limit_price = amount_reward_two %}
{% endif %}

<div class="cart-wrapper">
  {% render 'cart-header'
    title: cart_title,
  %}

  {% render 'cart-items'
    cart: cart
  %}

  {% render 'cart-bar-rewards'
    active_reward_two: active_reward_two,
    active_reward_three: active_reward_three,
    amount_reward_one: amount_reward_one,
    product_reward_one: section.settings.product_reward_one,
    amount_reward_two: amount_reward_two,
    product_reward_two: section.settings.product_reward_two,
    amount_reward_three: amount_reward_three,
    product_reward_three: section.settings.product_reward_three,
    text_reward_one: section.settings.text_reward_one,
    text_reward_two: section.settings.text_reward_two,
    text_reward_three: section.settings.text_reward_three,
    limit_price: limit_price,
    cart_total: cart_total
  %}

  {% render 'cart-footer'
    cart: cart,
    shipping_info: section.settings.shipping_info,
  %}

  <span class="cart-close">
    {% render 'icon-close' %}
  </span>

</div>

{% schema %}
{
  "name": "Cart",
  "class": "cart",
  "settings": [
    {
      "type": "header",
      "content": "Cart configuration"
    },
    {
      "type": "text",
      "id": "shipping_info",
      "label": "Shipping inf",
      "default": " Le livraison estim√© : J+2/3"
    },
    {
      "type": "header",
      "content": "Gift products"
    },
    {
      "type": "number",
      "id": "amount_reward_one",
      "label": "limit amount product one",
      "default": 10
    },
    {
      "type": "text",
      "id": "text_reward_one",
      "label": "Text reward one",
      "default": "free product 1"
    },
    {
      "type": "product",
      "id": "product_reward_one",
      "label": "Product one"
    },
    {
      "type": "number",
      "id": "amount_reward_two",
      "label": "limit amount product two",
      "default": 50
    },
    {
      "type": "text",
      "id": "text_reward_two",
      "label": "Text reward two",
      "default": "free poduct 2"
    },
    {
      "type": "product",
      "id": "product_reward_two",
      "label": "Product two"
    },
    {
      "type": "number",
      "id": "amount_reward_three",
      "label": "limit amount product three",
      "default": 100
    },
    {
      "type": "text",
      "id": "text_reward_three",
      "label": "Text reward three",
      "default": "free product 3"
    },
    {
      "type": "product",
      "id": "product_reward_three",
      "label": "Product three"
    },
    {
      "type": "header",
      "content": "active rewards"
    },
    {
      "type": "checkbox",
      "id": "active_reward_two",
      "label": "Active reward one",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "active_reward_three",
      "label": "Active reward three",
      "default": true
    }
  ]
}
{% endschema %}
